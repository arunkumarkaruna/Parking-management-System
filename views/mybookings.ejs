<!DOCTYPE html>
<html :class="{ 'theme-dark': dark }" x-data="data()" lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Bookings</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/tailwind.output.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" />
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    <script src="../js/init-alpine.js"></script>
</head>
<body class="dark:bg-black">
    <div class="antialiased font-sans dark:bg-black bg-purple-100 mt-5 rounded">
        <div id="countdowntimer"><span id="future_date"></span></div>
        <button class="bg-purple-300  uppercase px-8 py-3 ml-2 mt-2 hover:bg-purple-400 rounded-full  font-serif text-purple-100 mr-1 mb-1" type="button">
            <a href="/dashboard" class="hover:no-underline hover:text-purple-100">Back to Dashboard</a>
          </button>
        <div class="container mx-auto px-4 sm:px-8">
          <div class="py-8">
              <div>
                <h2 class="text-2xl text-purple-500 font-serif leading-tight">My Bookings</h2>
              </div>
              </div> 
              <div class="-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto">
                  <div class="inline-block min-w-full shadow rounded-lg overflow-hidden">
                      <table class="min-w-full leading-normal">
                          <thead>
                              <tr>
                                  <th
                                      class="dark:bg-black px-4 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Spot Owner
                                  </th>
                                  <th
                                      class="dark:bg-black px-2 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Booking Date
                                  </th>
                                   <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Time Needed
                                  </th>
                                  <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Start Time 
                                  </th>
                                  <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      End Time
                                  </th>
                                  <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                     Area
                                  </th> 
                                  <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Status
                                  </th>
                                  <th
                                      class="dark:bg-black px-5 py-3 border-b-2 border-gray-200 bg-purple-100 text-left text-xs font-semibold text-purple-500 uppercase tracking-wider">
                                      Action
                                  </th>
                              </tr>
                          </thead>
                          <tbody>
                             <% for (var i=0; i<booking.length ; i++) { %>
                              <% if ((userEmailInSession == userEmailWhoBooked[i]) && (paymentstatus[i] == true)) { %>
                                <tr>
                                  <td class="dark:bg-black px-5 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                      <div class="flex items-center">
                                          <div>
                                              <p class="text-indigo-500 whitespace-no-wrap">
                                                  <%= firstname[i] %>
                                              </p>
                                          </div>
                                      </div>
                                  </td>
                                  <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                    <p class="text-indigo-500 whitespace-no-wrap"><%= createdAt[i] %></p>
                                </td>
                                  <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                    <span
                                        class="relative inline-block px-3 py-1 font-semibold text-green-900 dark:text-green-200 leading-tight ml-5">
                                        <span aria-hidden
                                            class="absolute inset-0 bg-green-200 dark:bg-green-900 opacity-50 rounded-full"></span>
                                        <span id="min" class="relative text-right"><%= time[i] %> <%= timeflag[i] %></span>
                                    </span>
                                </td>
                                
                                <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                  <span
                                      class="relative inline-block px-3 py-1 font-semibold text-green-900 dark:text-green-200 leading-tight ml-3">
                                      <span aria-hidden
                                          class="absolute inset-0 bg-green-200 dark:bg-green-900 opacity-50 rounded-full"></span>
                                          <% var d = start[i];
                                          var s = "" + d;
                                          var t = s.slice(11, 20) %>
                                      <span id="time" class="relative text-right"><%= t %></span>
                                  </span>
                              </td>
                              <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                <span
                                    class="relative inline-block px-3 py-1 font-semibold text-green-900 dark:text-green-200 leading-tight ml-3">
                                    <span aria-hidden
                                        class="absolute inset-0 bg-green-200 dark:bg-green-900 opacity-50 rounded-full"></span>
                                        <% var d1 = end[i]; 
                                        var s1 = "" + d1;
                                        var t1 = s1.slice(11, 20)
                                     %>
                                    <span id="endtime" class="relative text-right"><%= t1 %></span>
                                </span>
                            </td>
                                <td class="dark:bg-black px-4 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                    <p class="text-indigo-500 whitespace-no-wrap">
                                        <%= area[i] %>
                                    </p>
                                </td>
                                <% if (expirystatus[i] == true) { %>
                                    <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                        <span
                                            class="relative inline-block px-3 py-1 font-semibold text-red-900 dark:text-red-200 leading-tight ml-5">
                                            <span aria-hidden
                                                class="absolute inset-0 bg-red-200 dark:bg-red-900 opacity-50 rounded-full"></span>
                                            <span id="min" class="relative text-right">Expired</span>
                                        </span>
                                    </td>
                                <% } else { %>
                                    <td class="dark:bg-black px-3 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                        <span
                                            class="relative inline-block px-3 py-1 font-semibold text-green-900 dark:text-green-200 leading-tight ml-5">
                                            <span aria-hidden
                                                class="absolute inset-0 bg-green-200 dark:bg-green-900 opacity-50 rounded-full"></span>
                                            <span id="min" class="relative text-right">Active</span>
                                        </span>
                                    </td>
                                <% } %>
                                <td class="dark:bg-black px-5 py-2 border-b border-gray-200 bg-purple-50 text-sm">
                                    <form action="/deletemybooking/<%= id[i] %>" method="post">
                                    <button type="submit" class="rounded-full">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="fill-current text-red-600 h-7 w-15">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                    </form>
                              </td>
                              </tr>
                            <%} else { continue; } %>
                          <% } %>
                          </tbody>
                      </table>
    <!-- Grouped circle -->
        <% if(pages > 0) { %> <!-- show pagination if there is pages -->
        <div class="mb-10 w-full md:w-1/2 text-center md:text-left">
          <div class="inline-block mt-3" style="margin-left: 30rem;">
              <span class="text-xs xs:text-sm text-indigo-500">Showing 1 to 10 of <%= count %> Entries</span>
            <hr class="my-2">
            <nav class="inline-flex shadow-md text-sm leading-5 text-purple-600 dark:bg-black bg-purple-50 border-gray-400 rounded-full py-2 px-4">
                <% if(current == 1) { %>
                <a href="#" class="flex mx-1 h-10 items-center justify-center disabled:opacity-50 hover:no-underline hover:text-purple-600">
                First<!-- prev -->
              </a>
              <% } else { %>
                <a href="1" class="flex mx-1 h-10 items-center justify-center hover:no-underline hover:text-purple-600">First</a>
                <% } %>
                  <!-- ITEMS  -->
              <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
              <% if(i !== 1) { %>
                <a href="#" class="flex mx-1 rounded-full w-10 h-10 items-center justify-center hover:bg-gray-300 transition ease-in-out duration-300 disabled:opacity-50 hover:no-underline hover:text-purple-600">
                ...
              </a>
              <% } %>
              <% for(; i <= (Number(current) + 4) && i <= pages; i++) { %>
                <% if(i == current) { %>
                    <a href="<%= i %>" class="flex mx-1 rounded-full w-10 h-10 items-center justify-center hover:bg-gray-300 transition ease-in-out duration-300 hover:no-underline hover:text-purple-600">
                        <%= i %>
                      </a>
                <% } else { %>
                    <a href="<%= i %>" class="flex mx-1 rounded-full w-10 h-10 items-center justify-center hover:bg-gray-300 transition ease-in-out duration-300 hover:no-underline hover:text-purple-600"><%= i %></a>
                    <% } %>
                <% if (i == Number(current) + 4 && i < pages) { %>
                    <a href="#" class="flex mx-1 rounded-full w-10 h-10 items-center justify-center shadow-sm bg-blue-600 hover:bg-blue-500 text-gray-100 disabled:opacity-50 hover:no-underline hover:text-purple-600">...</a>
              <% } %>
              <% } %>
                <!-- LAST ITEM -->
                <% if(current == pages) { %>
              <a href="#" class="flex mx-1 h-10 items-center justify-center disabled:opacity-50 hover:no-underline hover:text-purple-600">
               <!-- next --> Last
              </a>
              <% } else { %>
                <a href="<%= pages %>" class="flex mx-1 h-10 items-center justify-center hover:no-underline hover:text-purple-600">Last</a>
                <% } %>
                  </nav>
                      </div>
                    </div>
                    <% } %>
                  </div>
              </div>
          </div>
      </div>
    
</body>
</html>